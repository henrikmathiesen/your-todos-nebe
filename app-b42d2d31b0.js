angular.module("backend",["ngMockE2E"]).run(["$httpBackend","backendFactory",function(o,t){var e={headers:{"Content-Type":"application/json"}};o.whenGET("/api/todos").respond(function(){var o=t.getTodos();return[200,o,e]}),o.whenPOST("/api/todo").respond(function(o,n,d){var r=angular.fromJson(d),c=t.addTodo(r);return[201,c,e]}),o.whenPUT(/\/api\/todo\/\d+/).respond(function(o,n,d){var r=n.split("/")[3],c=angular.fromJson(d),u=t.updateTodo(r,c),a=u?200:404;return[a,u,e]}),o.whenDELETE(/\/api\/todo\/\d+/).respond(function(o,e,n){var d=e.split("/")[3],r=t.deleteTodo(d),c=r?204:404;return[c,{},{}]})}]),$(function(){FastClick.attach(document.body)}),angular.module("main",["templatecache","backend","todos","shared"]),angular.module("shared",[]),angular.module("todos",[]),angular.module("backend").factory("backendFactory",function(){var o={},t=[{id:1,text:"Keep up with front end stuff"},{id:2,text:"Assemble a tshirt gun"},{id:3,text:"Make sure there are an equal amount of blue berries in each muffin"},{id:4,text:"Juggle and fail"},{id:5,text:"Study Angular"},{id:6,text:"Study React"},{id:7,text:"Lorem ipsum dolores"}],e=function(){if(!t.length)return 1;var o=t.map(function(o){return o.id}),e=o.sort(function(o,t){return o-t});return e.pop()+1};return o.getTodos=function(){return t},o.addTodo=function(o){return o.id=e(),t.push(o),o},o.updateTodo=function(o,e){var n=t.map(function(o){return o.id.toString()}).indexOf(o.toString());return n<0?null:(t.splice(n,1,e),e)},o.deleteTodo=function(o){for(var e=!1,n=0;n<t.length;n++)if(t[n].id==o){e=!0,t.splice(n,1);break}return e},o}),angular.module("shared").factory("errorHandlerFactory",function(){var o={},t=!1;return o.getAppHasError=function(){return t},o.setAppHasError=function(o){t=o},o}),angular.module("shared").directive("ytError",["$timeout","errorHandlerFactory",function(o,t){return{restrict:"E",scope:{},templateUrl:"shared/yt-error.template.html",replace:!0,link:function(e,n){e.vm={showError:!1,ok:function(){t.setAppHasError(!1)}};var d=function(t){o(function(){e.vm.showError=t})};e.$watch(t.getAppHasError,function(o,t){if(o===!0)n.fadeIn(function(){d(!0)});else{if(o===t)return;n.fadeOut(function(){d(!1)})}})}}}]),angular.module("todos").directive("ytTodos",function(){return{restrict:"E",scope:{},templateUrl:"todos/yt-todos.template.html",replace:!0,controller:"ytTodosController as vm",bindToController:!0}}).controller("ytTodosController",["todosCrudFactory","todosEffectFactory",function(o,t){var e=this;e.todos=[],e.allTodosChecked=!1,e.noTodosChecked=!0;var n=function(){o.getTodos().then(function(o){e.todos=o})};e.isAllTodosChecked=function(){t.isAllTodosChecked(e)},e.checkAllTodos=function(o){t.checkAllTodos(e,o)},e.addTodo=function(){var o={id:null,text:""};t.addTodo(e,o)},e.updateCheckedTodos=function(){t.updateCheckedTodos(e)},e.deleteCheckedTodos=function(){t.deleteCheckedTodos(e)},e.reload=n,n()}]),angular.module("todos").directive("ytTodo",function(){return{restrict:"E",scope:{},templateUrl:"todos/todo/yt-todo.template.html",replace:!0,controller:"ytTodoController as subVm",bindToController:{todo:"=",isAllTodosChecked:"&"}}}).controller("ytTodoController",["todosEffectFactory",function(o){var t=this;t.checkTodo=function(e){t.todo.checked=e,t.todo.isInEditMode=e,t.isAllTodosChecked(),o.setFocus(t.todo.id)}}]),angular.module("todos").factory("todosApiFactory",["$http",function(o){var t={};return t.getTodos=function(){return o.get("/api/todos")},t.addTodo=function(t){return o.post("/api/todo",t)},t.updateTodo=function(t){return o.put("/api/todo/"+t.id,t)},t.deleteTodo=function(t){return o.delete("/api/todo/"+t)},t}]),angular.module("todos").factory("todosCrudFactory",["$q","todosApiFactory","errorHandlerFactory",function(o,t,e){var n={},d=function(t){return e.setAppHasError(!0),o.reject()},r=function(o){return o.data};return n.getTodos=function(){return t.getTodos().then(r).catch(d)},n.addTodo=function(o){return t.addTodo(o).then(r).catch(d)},n.updateTodo=function(o){return t.updateTodo(o).then(r).catch(d)},n.deleteTodo=function(o){return t.deleteTodo(o).then(r).catch(d)},n}]),angular.module("todos").factory("todosEffectFactory",["todosCrudFactory","$q","$timeout",function(o,t,e){var n={};n.isAllTodosChecked=function(o){return o.todos.length?(o.allTodosChecked=o.todos.every(function(o){return o.checked}),void(o.noTodosChecked=!o.todos.some(function(o){return o.checked}))):(o.allTodosChecked=!1,void(o.noTodosChecked=!0))},n.checkAllTodos=function(o,t){o.todos.map(function(o){o.checked=t,o.isInEditMode=t}),n.isAllTodosChecked(o)},n.addTodo=function(t,e){o.addTodo(e).then(function(o){t.todos.push(o),n.setCheckedAndEditMode(t,o.id),n.isAllTodosChecked(t),n.setFocus(o.id)})},n.updateCheckedTodos=function(e){var d=[],r=[],c=function(){var o=e.todos.filter(function(o){return o.checked===!0});angular.forEach(o,function(o){n.unSetCheckedAndEditMode(e,o.id)}),n.isAllTodosChecked(e)},u=function(){angular.forEach(d,function(o){o.fadeTo(100,.1).fadeTo(200,1)}),c()};angular.forEach(e.todos,function(t){t.checked&&(d.push(angular.element("div[data-todo-id="+t.id+"]")),r.push(o.updateTodo(t)))}),t.all(r).then(u)},n.deleteCheckedTodos=function(e){var d=[],r=[],c=[],u=function(){e.todos=e.todos.filter(function(o){return o.checked!==!0}),n.isAllTodosChecked(e)},a=function(){angular.forEach(d,function(o){c.push(o.fadeOut().promise())}),t.all(c).then(u)};angular.forEach(e.todos,function(t){t.checked&&(d.push(angular.element("div[data-todo-id="+t.id+"]")),r.push(o.deleteTodo(t.id)))}),t.all(r).then(a)};var d=function(o,t,e){o.todos.map(function(o){o.id==t&&(o.checked=e,o.isInEditMode=e)})};return n.setCheckedAndEditMode=function(o,t){d(o,t,!0)},n.unSetCheckedAndEditMode=function(o,t){d(o,t,!1)},n.setFocus=function(o){e(function(){var t=angular.element('div[data-todo-id="'+o+'"]').find("input");t.focus()},0)},n}]);